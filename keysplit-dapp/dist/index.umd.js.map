{"version":3,"file":null,"sources":["../src/wordEncode.js","../src/KeySplit.js","../src/keySplitWeb3.js","../src/hashPass.js","../src/app.js"],"sourcesContent":["/*\n * This module does bip39-like encoding of byte strings to words. It removes\n * the constraint from the original bip39 module to ensure that the encoded\n * bytes are 128 < x < 256 bits. We still want to use bip39 for encoding and\n * decoding actual keys, but when it comes to encoding the Shamir's Secret\n * Sharing shards we want a human-readable encoding that can exceed 256 bits\n * and may not be divisible by 4.\n */\n\nimport bip39 from 'bip39';\nimport createHash from 'create-hash';\nimport unorm from 'unorm';\n\nvar INVALID_ENTROPY = 'Invalid entropy';\nvar INVALID_MNEMONIC = 'Invalid mnemonic';\nvar INVALID_CHECKSUM = 'Invalid mnemonic checksum';\n\n\nfunction bytesToBinary (bytes) {\n  return bytes.map(function (x) {\n    return lpad(x.toString(2), '0', 8)\n  }).join('')\n}\n\nfunction binaryToByte (bin) {\n  return parseInt(bin, 2)\n}\n\nfunction lpad (str, padString, length) {\n  while (str.length < length) str = padString + str\n  return str\n}\n\n\nfunction deriveChecksumBits (entropyBuffer) {\n  var ENT = entropyBuffer.length * 8\n  var CS = ENT / 32\n  var hash = createHash('sha256').update(entropyBuffer).digest()\n\n  return bytesToBinary([].slice.call(hash)).slice(0, CS)\n}\n\nfunction salt (password) {\n  return 'mnemonic' + (password || '')\n}\n\nexport function entropyToMnemonic (entropy, wordlist) {\n  if (!Buffer.isBuffer(entropy)) entropy = Buffer.from(entropy, 'hex')\n  wordlist = wordlist || bip39.wordlists.EN;\n\n  if (entropy.length % 4 !== 0) throw new TypeError(INVALID_ENTROPY);\n\n  var entropyBits = bytesToBinary([].slice.call(entropy))\n  var checksumBits = deriveChecksumBits(entropy)\n\n  var bits = entropyBits + checksumBits\n  var chunks = bits.match(/(.{1,11})/g)\n  var words = chunks.map(function (binary) {\n    var index = binaryToByte(binary)\n    return wordlist[index]\n  })\n\n  return wordlist === bip39.wordlists.JA ? words.join('\\u3000') : words.join(' ')\n}\n\nexport function mnemonicToEntropy (mnemonic, wordlist) {\n  wordlist = wordlist || bip39.wordlists.EN;\n\n  var words = unorm.nfkd(mnemonic).split(' ')\n  // if (words.length % 3 !== 0) throw new Error(INVALID_MNEMONIC)\n\n  // convert word indices to 11 bit binary strings\n  var bits = words.map(function (word) {\n    var index = wordlist.indexOf(word)\n    if (index === -1) throw new Error(INVALID_MNEMONIC)\n\n    return lpad(index.toString(2), '0', 11)\n  }).join('')\n\n  // split the binary string into ENT/CS\n  var dividerIndex = Math.floor(bits.length / 33) * 32\n  var entropyBits = bits.slice(0, dividerIndex)\n  var checksumBits = bits.slice(dividerIndex)\n\n  // calculate the checksum and compare\n  var entropyBytes = entropyBits.match(/(.{1,8})/g).map(binaryToByte)\n\n  var entropy = Buffer.from(entropyBytes)\n  var newChecksum = deriveChecksumBits(entropy)\n  if (newChecksum !== checksumBits) throw new Error(INVALID_CHECKSUM)\n\n  return entropy.toString('hex')\n}\n","import secrets from 'secrets.js-next';\nimport bip39 from 'bip39';\nimport {entropyToMnemonic} from './wordEncode.js';\nimport {mnemonicToEntropy} from './wordEncode.js';\nimport crypto from 'crypto';\nimport rp from 'request-promise-native';\n\nfunction repeat(char, number) {\n  var string = \"\";\n  for(var i = 0; i < number; i++) {\n    string += char;\n  }\n  return string;\n}\n\nclass ApiEndpoint {\n  constructor(apiServer) {\n    this.apiServer = apiServer\n  }\n  upload(body) {\n    return rp({\n      method: 'POST',\n      uri: this.apiServer,\n      body: body,\n      json: true\n    });\n  }\n  download(shardid) {\n    return rp({\n      method: 'GET',\n      uri: `${this.apiServer}?id=${shardid}`,\n      json: true\n    });\n  }\n}\n\nvar passwordStore = {};\n\nclass KeySplit {\n  constructor(options={}) {\n    if(typeof window === \"undefined\") {\n      var window = {};\n    }\n    this.apiUrl = options.apiUrl || \"https://cgr6zthug7.execute-api.us-east-2.amazonaws.com/keysplit\";\n    this.localStorage = options.localStorage || window.localStorage;\n    this.account = options.account;\n    passwordStore[this] = options.password;\n  }\n  mnemonicToSSS(mnemonic, shareCount, threshold, password) {\n    password = password || passwordStore[this];\n    var key = bip39.mnemonicToEntropy(mnemonic);\n    var salt = crypto.randomBytes(8);\n    return new Promise((resolve, reject) => {\n      return crypto.pbkdf2(password, salt, 100000, 16, 'sha512', (err, pbkdf2Pass) => {\n        if(err) { reject(err) }\n        var c = crypto.createCipher(\"aes128\", pbkdf2Pass);\n        var encKey = c.update(key, 'hex', 'hex');\n        encKey += c.final('hex')\n        var splitVal = salt.toString(\"hex\") + encKey;\n        var shares = secrets.share(splitVal, shareCount, threshold);\n        var mnemonicShares = [];\n        for(var share of shares) {\n          mnemonicShares.push(entropyToMnemonic(share + \"000\"));\n        }\n        resolve(mnemonicShares);\n      });\n    });\n  }\n  combineSSS(mnemonicShares, password) {\n    password = password || passwordStore[this];\n    var shares = [];\n    for(var share of mnemonicShares) {\n      var shareHex = mnemonicToEntropy(share);\n      shares.push(shareHex.slice(0, shareHex.length - 3));\n    }\n    var splitVal = secrets.combine(shares);\n    var salt = new Buffer(splitVal.slice(0, 16), \"hex\");\n    var encKey = splitVal.slice(16);\n    return new Promise((resolve, reject) => {\n      return crypto.pbkdf2(password, salt, 100000, 16, 'sha512', (err, pbkdf2Pass) => {\n        if(err) { reject(err) }\n        var d = crypto.createDecipher(\"aes128\", pbkdf2Pass);\n        var rawKey = d.update(encKey, \"hex\", \"hex\");\n        rawKey += d.final(\"hex\");\n        return bip39.entropyToMnemonic(rawKey);\n      });\n    })\n  }\n  uploadShard(shard, uploader) {\n    uploader = uploader || new ApiEndpoint(this.apiUrl);\n    var hash = crypto.createHash('sha256');\n    var shardHex = mnemonicToEntropy(shard);\n    hash.update(shardHex, \"hex\")\n    var result = {\n      shardid: hash.digest(),\n      key: crypto.randomBytes(32),\n    }\n    var c = crypto.createCipher(\"aes256\", result.key);\n    var encShard = c.update(shardHex, \"hex\", \"base64\");\n    encShard += c.final(\"base64\");\n    if(this.localStorage) {\n      var shardList = JSON.parse(this.localStorage.getItem(`${this.account}:shards`));\n      if(shardList.indexOf(result.shardid.toString(\"hex\")) < 0) {\n        shardList.push(result.shardid.toString(\"hex\"));\n      }\n      this.localStorage.setItem(`${this.account}:shards`, JSON.stringify(shardList));\n    }\n    return uploader.upload({shardid: result.shardid, data: encShard}).then((response) => {\n      result.objectid = response;\n      return result\n    });\n  }\n  downloadShard(pathAndKey, downloader) {\n    downloader = downloader || new ApiEndpoint(this.apiUrl);\n    var objectid, key;\n    [objectid, key] = pathAndKey.split(\":\");\n    console.log(pathAndKey);\n    return downloader.download(objectid).then((response) => {\n      console.log(objectid, key);\n      var d = crypto.createDecipher(\"aes256\", new Buffer(key, \"base64\"));\n      var shardHex = d.update(response.data, \"base64\", \"hex\");\n      shardHex += d.final(\"hex\");\n      console.log(entropyToMnemonic(shardHex));\n      return entropyToMnemonic(shardHex);\n    })\n  }\n  saveShard(shard, password) {\n    return new Promise((resolve, reject) => {\n      password = password || passwordStore[this];\n      var salt = crypto.randomBytes(8);\n      crypto.pbkdf2(password, salt, 100000, 16, 'sha512', (err, pbkdf2Pass) => {\n        if(err) { reject(err); return }\n        var c = crypto.createCipher(\"aes128\", pbkdf2Pass);\n        var shardHex = mnemonicToEntropy(shard);\n        var encShard = c.update(shardHex, 'hex', 'hex');\n        encShard += c.final('hex');\n        var splitVal = salt.toString(\"hex\") + encShard;\n        var hash = crypto.createHash('sha256');\n        hash.update(shardHex, \"hex\")\n        var shardId = hash.digest(\"hex\");\n        this.localStorage.setItem(`encShard:${shardId}`, splitVal);\n        var shardList = JSON.parse(this.localStorage.getItem(`${this.account}:heldShards`));\n        if(!shardList) {\n          shardList = [];\n        }\n        if(shardList.indexOf(shardId) < 0) {\n          shardList.push(shardId);\n        }\n        this.localStorage.setItem(`${this.account}:heldShards`, JSON.stringify(shardList));\n        resolve(shardId);\n      });\n    });\n  }\n  getShard(shardId, password) {\n    return new Promise((resolve, reject) => {\n      var splitVal = this.localStorage.getItem(`encShard:${shardId}`);\n      var salt = new Buffer(splitVal.slice(0, 16), \"hex\");\n      var encShard = splitVal.slice(16);\n      crypto.pbkdf2(password, salt, 100000, 16, 'sha512', (err, pbkdf2Pass) => {\n        if(err) { reject(err) }\n        var d = crypto.createDecipher(\"aes128\", pbkdf2Pass);\n        var rawShard = d.update(encShard, \"hex\", \"hex\");\n        rawShard += d.final(\"hex\");\n        resolve(bip39.entropyToMnemonic(rawShard));\n      });\n    })\n  }\n};\n\nexport default KeySplit;\n","\nimport ShardStore from \"../solidity/build/contracts/ShardStore.json\";\n\nimport BigNumber from \"bignumber.js\";\n\nexport class KeySplitContractInterface {\n  constructor (options={}) {\n    this.web3 = options.web3;\n    this.contract = this.web3.eth.contract(ShardStore.abi).at(options.at || \"0x8cdaf0cd259887258bc13a92c0a6da92698644c0\");\n    this.localStorage = options.localStorage;\n    if(this.localStorage) {\n      this.web3.eth.getAccounts((err, accounts) => {\n        this.account = accounts[0];\n        var shardList = JSON.parse(this.localStorage.getItem(`${accounts[0]}:shards`));\n        if(!shardList) { shardList = []; }\n        for(var shard of shardList) {\n          getStorageConfirmed(shard);\n        }\n      });\n    }\n  }\n\n  stop() {\n    if(this.engine) {\n      this.engine.stop();\n    }\n  }\n\n  deploy() {\n    this.web3.eth.getAccounts((err, accounts) => {\n      if(err) {\n        console.log(err);\n        return;\n      }\n      var defaultAccount = accounts[0];\n      this.web3.eth.contract(ShardStore.abi).new({data: ShardStore.bytecode, gas: 1000000, from: defaultAccount}, (err, data) => {\n        console.log(data);\n      });\n    })\n  }\n\n  confirmStorage(shardIds) {\n    return new Promise((resolve, reject) => {\n      this.web3.eth.getAccounts((err, accounts) => {\n        if(err) { reject(err); return; }\n        var defaultAccount = accounts[0];\n        var shardNumbers = [];\n        for(var shardId of shardIds){\n          shardNumbers.push(new BigNumber(shardId, 16));\n        }\n        console.log(shardNumbers);\n        this.contract.confirmStorage.estimateGas(shardNumbers, {from: defaultAccount}, (err, gas) => {\n          this.contract.confirmStorage(shardNumbers, {from: defaultAccount, gas: gas}, (err, tx) => {\n            if(err) {\n              reject(err);\n              return;\n            }\n            resolve(tx);\n          });\n        })\n      });\n    })\n  }\n\n  watchStorageConfirmed(shardId) {\n    return new Promise((resolve, reject) => {\n      var watcher = this.contract.StorageConfirmed({fromBlock: \"latest\", shardId: new BigNumber(shardId, 16)});\n      watcher.watch((err, evt) => {\n        if(err) {\n          watcher.stopWatching(() => {});\n          reject(err)\n        }\n        watcher.stopWatching(() => {});\n        if(this.localStorage) {\n          this.localStorage.setItem(`shard:${shardId}`, JSON.stringify({block: evt.blockNumber, trustedContact: evt.args.trustedContact}));\n        }\n        resolve({block: evt.blockNumber, trustedContact: evt.args.trustedContact});\n      });\n    });\n  }\n\n  getStorageConfirmed(shardId) {\n    if(this.localStorage) {\n      var shardData = JSON.parse(this.localStorage.getItem(`shard:${shardId}`));\n    } else {\n      var shardData = {block: 0};\n    }\n    return new Promise((resolve, reject) => {\n      var watcher = this.contract.StorageConfirmed({fromBlock: shardData.block, shardId: new BigNumber(shardId, 16)});\n      watcher.get((err, evts) => {\n        if(err) {\n          reject(err)\n        }\n        for(var evt of evts) {\n          if(evt.blockNumber > shardData.block) {\n            if(this.localStorage) {\n              this.localStorage.setItem(`shard:${shardId}`, JSON.stringify({block: evt.blockNumber, trustedContact: evt.args.trustedContact}));\n            }\n            resolve({block: evt.blockNumber, trustedContact: evt.args.trustedContact});\n          }\n        }\n      });\n    });\n  }\n  getShardStatus() {\n    return new Promise((resolve, reject) => {\n      if(!this.localStorage) {\n        resolve([]);\n      }\n      this.web3.eth.getAccounts((err, accounts) => {\n        var shardJSON = this.localStorage.getItem(`${accounts[0]}:shards`);\n        if(!shardJSON) {\n          reject(\"No shards yet\");\n        }\n        var shardIds = JSON.parse(shardJSON);\n        var shards = [];\n        for(var shardId of shardIds) {\n          var shard = JSON.parse(this.localStorage.getItem(`shard:${shardId}`));\n          shard.update = this.watchStorageConfirmed(shardId);\n        }\n        resolve(shards);\n      });\n    })\n  }\n  getHeldShards() {\n    return JSON.parse(this.localStorage.getItem(`${this.account}:heldShards`));\n  }\n  confirmStoredShards() {\n    return new Promise((resolve, reject) => {\n      if(!this.localStorage) {\n        resolve([]);\n      }\n      var heldShards = JSON.parse(this.localStorage.getItem(`${this.account}:heldShards`));\n      var currentShards = [];\n      for(var shardId of heldShards) {\n        if(this.localStorage.getItem(`encShard:${shardId}`)) {\n          currentShards.push(shardId);\n        }\n      }\n      resolve(this.confirmStorage(currentShards));\n    });\n  }\n\n\n\n}\n","import crypto from 'crypto';\n\nexport class PasswordManagement {\n  constructor(localStorage) {\n    this.localStorage = localStorage;\n  }\n  hashPass(password) {\n    var salt = crypto.randomBytes(8);\n    return new Promise((resolve, reject) => {\n      crypto.pbkdf2(password, salt, 100000, 16, 'sha256', (err, pbkdf2Pass) => {\n        if(err) { reject(err) }\n        resolve({hash: pbkdf2Pass.toString(\"hex\"), salt: salt.toString(\"hex\")});\n      });\n    });\n  }\n  checkPass(password, hash, salt) {\n    return new Promise((resolve, reject) => {\n      crypto.pbkdf2(password, new Buffer(salt, \"hex\"), 100000, 16, 'sha256', (err, pbkdf2Pass) => {\n        if(err) { reject(err) }\n        resolve(pbkdf2Pass.equals(new Buffer(hash, \"hex\")));\n      });\n    })\n  }\n  storePass(password, account) {\n    return this.hashPass(password).then((result) => {\n      this.localStorage.setItem(`${account}:password`, JSON.stringify(result));\n    })\n  }\n  checkAccountPass(password, account) {\n    var pdata = JSON.parse(this.localStorage.getItem(`${account}:password`));\n    if(pdata) {\n      return this.checkPass(password, pdata.hash, pdata.salt);\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n  hasAccountPass(account) {\n    return !!this.localStorage.getItem(`${account}:password`);\n  }\n}\n","import KeySplit from './KeySplit.js';\nimport {PasswordManagement} from './hashPass.js';\nimport {KeySplitContractInterface} from './keySplitWeb3.js';\n\nimport Web3 from \"web3\";\nimport ProviderEngine from \"web3-provider-engine\";\nimport FixtureSubprovider from \"web3-provider-engine/subproviders/fixture.js\";\nimport FilterSubprovider from \"web3-provider-engine/subproviders/filters.js\";\nimport WalletSubprovider from \"ethereumjs-wallet/provider-engine\";\nimport Web3Subprovider from \"web3-provider-engine/subproviders/web3.js\";\n\nimport Wallet from \"ethereumjs-wallet\";\n\n\nexport class App {\n  /*\n   * Construct with {}\n   */\n  constructor(options={}) {\n    var rpcURL = options.rpcURL || \"https://ropsten.infura.io/atjfYkLXBNdLI0zSm9eE\"\n    if(typeof window === 'undefined') {\n      var window = {};\n    }\n    this.localStorage = options.localStorage || window.localStorage;\n    if(options.currentProvider) {\n      this.web3 = new Web3(options.currentProvider);\n    } else if(window && window.web3) {\n      this.web3 = new Web3(window.web3.currentProvider);\n    } else {\n      var privateKey = options.privateKey || localStorage.getItem(\"localPrivateKey\");\n      if(!privateKey) {\n        privateKey = Wallet.generate().getPrivateKeyString().slice(2);\n        if(localStorage) {\n        localStorage.setItem(\"localPrivateKey\", privateKey)}\n      }\n      var wallet = Wallet.fromPrivateKey(new Buffer(privateKey, \"hex\"));\n      this.engine = new ProviderEngine();\n      this.web3 = new Web3(this.engine);\n      // static results\n      this.engine.addProvider(new FixtureSubprovider({\n        web3_clientVersion: 'ProviderEngine/v0.0.0/javascript',\n        net_listening: true,\n        eth_hashrate: '0x00',\n        eth_mining: false,\n        eth_syncing: true,\n      }))\n\n      // filters\n      this.engine.addProvider(new FilterSubprovider())\n\n      // id mgmt\n      this.engine.addProvider(new WalletSubprovider(wallet, {}))\n\n      this.engine.addProvider(new Web3Subprovider(new Web3.providers.HttpProvider(rpcURL)));\n\n      this.engine.on('block', function(block) {\n        console.log('BLOCK CHANGED:', '#'+block.number.toString('hex'), '0x'+block.hash.toString('hex'))\n      })\n\n      // network connectivity error\n      this.engine.on('error', function(err){\n        // report connectivity errors\n        console.error(err.stack)\n      });\n\n      // start polling for blocks\n      this.engine.start()\n    }\n    this.PasswordManagement = new PasswordManagement(this.localStorage);\n    this.ContractInterface = new KeySplitContractInterface({web3: this.web3, at: options.at, localStorage: this.localStorage});\n    this.KeySplitPromise = new Promise((resolve, reject) => {\n      this.ksResolve = resolve;\n      this.ksReject = reject;\n    });\n\n    this.account = new Promise((resolve, reject) => {\n      this.web3.eth.getAccounts((err, accounts) => {\n        if(err) { reject(err) }\n        resolve(accounts[0]);\n      })\n    })\n  }\n  hasAccount() {\n    return this.account.then((account) => {\n      return this.PasswordManagement.hasAccountPass(account);\n    })\n  }\n  signUp(password) {\n    return this.account.then((account) => {\n      this.ksResolve(new KeySplit({account: account, password: password, localStorage: this.localStorage}));\n      return this.PasswordManagement.storePass(password, account);\n    })\n  }\n  signIn(password) {\n    return this.account.then((account) => {\n      var result = this.PasswordManagement.checkAccountPass(password, account);\n      result.then(() => {\n        this.ksResolve(new KeySplit({account: account, password: password, localStorage: this.localStorage}));\n      });\n      return result\n    })\n  }\n  confirmFromUrlHash() {\n    var hash = window.location.hash.slice(1);\n    if(!hash) {\n      reject(\"No shard in url\");\n    }\n    return this.KeySplitPromise.then((KeySplit) => {\n      return KeySplit.downloadShard(hash).then((shardMnemonic) => {\n        console.log(\"got here mnemonic\");\n        return KeySplit.saveShard(shardMnemonic)\n      })\n    }).then((shardId) => {\n      console.log(\"got here\");\n      return this.ContractInterface.confirmStoredShards();\n    })\n  }\n  splitSeedAndUpload(seed) {\n    return this.KeySplitPromise.then((KeySplit) => {\n      return KeySplit.mnemonicToSSS(seed, 5, 3).then((mnemonicShards) => {\n        var shards = [];\n        for(var shard of mnemonicShards) {\n          shards.push(KeySplit.uploadShard(shard));\n        }\n        return Promise.all(shards);\n      });\n    }).then((results) => {\n      var urls = [];\n      for(var result of results) {\n        urls.push(`${window.location.origin}${window.location.pathname}#${result.objectid.objectid}:${result.key.toString(\"base64\")}`);\n      }\n      return urls;\n    })\n  }\n  distributedShardData() {\n    return this.ContractInterface.getShardStatus()\n  }\n  heldShardData() {\n    return getHeldShards();\n  }\n  getShardMnemonic(shardId) {\n    return this.ContractInterface.getShard(shardId);\n  }\n  currentBlock() {\n    return new Promise((resolve, reject) => {\n      this.web3.getBlockNumber((err, blocknum) => {\n        if(err) { reject(err) }\n        resolve(blocknum);\n      })\n    });\n  }\n}\n"],"names":["INVALID_ENTROPY","INVALID_MNEMONIC","INVALID_CHECKSUM","bytesToBinary","bytes","map","x","lpad","toString","join","binaryToByte","bin","parseInt","str","padString","length","deriveChecksumBits","entropyBuffer","ENT","CS","hash","createHash","update","digest","slice","call","entropyToMnemonic","entropy","wordlist","Buffer","isBuffer","from","bip39","wordlists","EN","TypeError","entropyBits","checksumBits","bits","chunks","match","words","binary","index","JA","mnemonicToEntropy","mnemonic","unorm","nfkd","split","word","indexOf","Error","dividerIndex","Math","floor","entropyBytes","newChecksum","ApiEndpoint","apiServer","body","rp","shardid","passwordStore","KeySplit","options","window","apiUrl","localStorage","account","password","shareCount","threshold","key","salt","crypto","randomBytes","Promise","resolve","reject","pbkdf2","err","pbkdf2Pass","c","createCipher","encKey","final","splitVal","shares","secrets","share","mnemonicShares","push","shareHex","combine","d","createDecipher","rawKey","shard","uploader","shardHex","result","encShard","shardList","JSON","parse","getItem","setItem","stringify","upload","data","then","response","objectid","pathAndKey","downloader","log","download","shardId","rawShard","KeySplitContractInterface","web3","contract","eth","ShardStore","abi","at","getAccounts","accounts","engine","stop","defaultAccount","new","bytecode","gas","shardIds","shardNumbers","BigNumber","confirmStorage","estimateGas","tx","watcher","StorageConfirmed","fromBlock","watch","evt","stopWatching","block","blockNumber","trustedContact","args","shardData","get","evts","shardJSON","shards","watchStorageConfirmed","heldShards","currentShards","PasswordManagement","equals","hashPass","pdata","checkPass","App","rpcURL","currentProvider","Web3","privateKey","Wallet","generate","getPrivateKeyString","wallet","fromPrivateKey","ProviderEngine","addProvider","FixtureSubprovider","FilterSubprovider","WalletSubprovider","Web3Subprovider","providers","HttpProvider","on","number","error","stack","start","ContractInterface","KeySplitPromise","ksResolve","ksReject","hasAccountPass","storePass","checkAccountPass","location","downloadShard","shardMnemonic","saveShard","confirmStoredShards","seed","mnemonicToSSS","mnemonicShards","uploadShard","all","results","urls","origin","pathname","getShardStatus","getHeldShards","getShard","getBlockNumber","blocknum"],"mappings":"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"}